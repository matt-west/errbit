- content_for :title, 'Apps'
- content_for :action_bar do
  .btn-toolbar
    .btn-group
      - if current_user.admin?
        %a{ :class => 'btn btn-primary', :href => new_app_path }
          %i{ :class => 'icon-plus-sign icon-white' }
          Add New App


%table.table.table-striped.table-bordered.apps
  %thead
    %tr
      %th Name
      - if any_github_repos?
        %th GitHub Repo
      - if any_issue_trackers?
        %th Tracker
      - if any_deploys?
        %th Last Deploy
      %th Errors
  %tbody
    - @apps.each do |app|
      %tr
        %td.name= link_to app.name, app_path(app)
        - if any_github_repos?
          %td.github_repo
            - if app.github_repo?
              = link_to(app.github_repo, app.github_url, :target => '_blank')
        - if any_issue_trackers?
          %td.issue_tracker
            - if app.issue_tracker_configured?
              - tracker_img = image_tag("#{app.issue_tracker.label}_goto.png")
              - if app.issue_tracker.url
                = link_to( tracker_img, app.issue_tracker.url )
              - else
                = tracker_img
        - if any_deploys?
          %td.deploy
            - if app.last_deploy_at
              - revision = app.deploys.last.short_revision
              = link_to( app.last_deploy_at.to_s(:micro) << (revision.present? ? " (#{revision})" : ""), app_deploys_path(app))
        %td.count
          - if @problem_counts[app.id] > 0
            - unresolved = @unresolved_counts[app.id]
            = link_to unresolved, app_path(app), :class => 'badge badge-important'
    - if @apps.none?
      - if current_user.admin?
        %tr
          %td{:colspan => 3}
            %a{ :class => 'btn btn-primary', :href => new_app_path }
              %i{ :class => 'icon-plus-sign icon-white' }
              Add New App

